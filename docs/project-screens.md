# docs/screens.md

## Экранные формы RentControl

Документ описывает экранные формы приложения RentControl на уровне UI-композиции. Для каждого экрана фиксируются зоны экрана, состав элементов, их расположение, поведения, состояния и переходы.

### Общие UI-принципы

- Верхняя панель приложения
    - Слева кнопка назад или меню.
    - По центру заголовок экрана.
    - Справа действия контекста, если применимо: поиск, фильтр, меню.
- Основная область контента
    - Вертикальная прокрутка.
    - Секции разделяются заголовками и карточками.
- Нижняя навигация
    - Включена на основных разделах и скрыта на экранах аутентификации и мастерах ввода.
    - Набор пунктов зависит от роли.
- Плавающая кнопка действия
    - Используется на списках для создания сущности, если роль позволяет.
- Состояния
    - Loading: скелетоны или индикатор загрузки внутри секций.
    - Empty: поясняющий текст и основное действие.
    - Error: баннер или экран ошибки с кнопкой повтора.
    - Offline: индикатор офлайн, действия сохраняются в очередь, на сущностях показывается статус “не синхронизировано”.

---

## Навигационная структура

### Нижнее меню

- Главная
- Объекты
- Осмотры
- Дефекты
- Расходы
- Профиль

### Правила видимости пунктов

- Администратор, арендодатель, инспектор
    - Все пункты доступны.
- Арендатор
    - Главная, Дефекты, Расходы, Профиль
    - Объекты и Осмотры скрыты или доступны только в режиме просмотра, если в бизнес-логике требуется.

---

## Экран входа

### Назначение

- Вход пользователя в систему.

### Роли

- Все роли.

### Структура и расположение

- Верхняя область
    - Логотип приложения или название RentControl.
    - Подзаголовок: “Вход”.
- Центральная форма
    - Поле ввода e-mail.
    - Поле ввода пароля.
    - Текстовая ссылка “Забыли пароль”.
    - Основная кнопка “Войти”.
- Нижняя область
    - Текст “Нет аккаунта”.
    - Ссылка “Регистрация”.

### Элементы

- TextFieldEmail
    - Тип: email
    - Валидация: обязательное, формат email
- TextFieldPassword
    - Тип: password
    - Валидация: обязательное, минимальная длина по политике
    - Иконка “показать пароль”
- LinkForgotPassword
- ButtonLogin
    - Disabled, пока форма не валидна
- LinkRegister

### Поведение

- Нажатие “Войти”
    - Отправка данных на сервер
    - При успехе переход на Главную
    - При ошибке отображение сообщения

### Состояния

- Loading
    - ButtonLogin показывает индикатор, поля блокируются
- ErrorInvalidCredentials
    - Текст под полями: “Неверный e-mail или пароль”
- ErrorAccountBlocked
    - Баннер или текст: “Аккаунт заблокирован”
- ErrorNetwork
    - Баннер “Нет соединения”, кнопка “Повторить”

---

## Экран регистрации

### Назначение

- Создание нового аккаунта и подтверждение e-mail.

### Роли

- Все роли.

### Структура и расположение

- Верхняя панель
    - Кнопка назад
    - Заголовок “Регистрация”
- Контент
    - Поле e-mail
    - Поле пароль
    - Поле подтверждение пароля
    - Кнопка “Получить код”
    - Блок подтверждения
        - Поле “Код из письма”
        - Кнопка “Подтвердить”
        - Ссылка “Отправить код повторно”
- Нижняя подсказка
    - Текст про политику пароля

### Элементы и валидация

- TextFieldEmail
- TextFieldPassword
- TextFieldPasswordRepeat
    - Валидация: совпадает с паролем
- ButtonRequestCode
- TextFieldOtpCode
    - Валидация: обязательное, длина кода
- ButtonConfirmRegistration
- LinkResendCode

### Состояния

- Loading при запросе кода и подтверждении
- ErrorEmailExists
- ErrorOtpInvalid
- ErrorNetwork

---

## Экран восстановления доступа

### Назначение

- Смена пароля через одноразовый код.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “Восстановление”
- Контент
    - Поле e-mail
    - Кнопка “Отправить код”
    - Поле “Код”
    - Поле “Новый пароль”
    - Кнопка “Сменить пароль”
    - Ссылка “Отправить код повторно”

### Элементы

- TextFieldEmail
- ButtonSendCode
- TextFieldOtpCode
- TextFieldNewPassword
- ButtonApplyNewPassword
- LinkResendCode

### Состояния

- Loading
- ErrorOtpInvalid
- ErrorNetwork

---

## Экран главной панели

### Назначение

- Сводка задач и быстрый доступ к критичным действиям.

### Структура и расположение

- Верхняя панель
    - Заголовок “Главная”
    - Иконка уведомлений
- Контент секциями сверху вниз
    - Секция “Ближайшие осмотры”
        - Горизонтальный список карточек или вертикальный список
        - Каждая карточка: дата/время, объект, статус, приоритет
    - Секция “Требует внимания”
        - Карточка “Просроченные дефекты”
        - Карточка “Осмотры на утверждение”
        - Карточка “Расходы на подтверждение”
    - Секция “Быстрые действия”
        - Кнопки-плитки: “Создать осмотр”, “Создать дефект”, “Добавить расход”
        - Набор плиток зависит от роли

### Элементы

- CardUpcomingInspectionItem
- CardIndicatorOverdueDefects
- CardIndicatorPendingApprovals
- CardIndicatorExpensesToConfirm
- QuickActionTile*

### Поведение

- Нажатие на карточку осмотра
    - Переход на “Детали осмотра” или “Выполнение осмотра” в зависимости от статуса
- Нажатие на индикатор
    - Переход на соответствующий список с заранее применённым фильтром
- Pull-to-refresh
    - Перезагрузка данных

### Состояния

- EmptyUpcomingInspections
    - Текст “Осмотров нет”, кнопка “Запланировать”
- Offline
    - Плашка “Офлайн”, используется локальный кэш
- ErrorNetwork
    - Блок ошибки на месте секций с кнопкой повторить

---

## Экран списка объектов

### Назначение

- Просмотр и поиск объектов.

### Структура и расположение

- Верхняя панель
    - Заголовок “Объекты”
    - Иконка поиска
    - Иконка фильтров
- Под панелью
    - Поисковая строка, если активирован режим поиска
    - Чипы активных фильтров
- Основной список
    - Карточка объекта
        - Строка 1: адрес
        - Строка 2: тип, площадь
        - Строка 3: статус заселения
        - Справа: индикаторы дефектов и финансовых отклонений
- Нижняя область
    - FloatingActionButton “+” для роли, у которой разрешено создание

### Элементы

- SearchFieldObjects
- FilterChipsRow
- ObjectListItemCard
    - BadgeDefectsCount
    - BadgeExpenseDeviation или BadgePendingConfirmations
- FABCreateObject

### Поведение

- Тап по карточке объекта
    - Открыть карточку объекта
- Тап по фильтрам
    - Открыть экран/шторку фильтра
- Тап по FAB
    - Открыть форму создания объекта

### Состояния

- Empty
    - Текст “Объекты не найдены”
    - Кнопка “Сбросить фильтры”
- Loading
    - Скелетоны карточек
- Error
    - Баннер и кнопка повтора

---

## Экран карточки объекта

### Назначение

- Единая точка доступа к данным по объекту.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок: адрес объекта
    - Меню действий: редактировать, архивировать, если разрешено ролью
- Верхняя сводка в контенте
    - Карточка “Параметры”
        - тип, площадь, статус заселения
    - Карточка “Арендатор”
        - имя/название, контакты, статус связи
    - Карточка “Сводка”
        - дефекты: число открытых и просроченных
        - осмотры: ближайший и последний
        - расходы: план/факт и отклонение
        - показания: дата последнего ввода
- Разделы контента
    - Tabs или вертикальные секции
        - Осмотры
        - Дефекты
        - Расходы
        - Приборы учёта
        - Журнал активности
- Нижние быстрые действия
    - Кнопки в одну строку или FAB-меню:
        - “Запланировать осмотр”
        - “Добавить дефект”
        - “Добавить расход”
        - “Ввести показания”

### Элементы

- SummaryCardParameters
- SummaryCardTenant
- SummaryCardOverview
- TabsSection или SectionList
- ActionBarButtons или FABMenu

### Поведение

- Переход по элементам разделов в карточки сущностей
- Меню действий зависит от роли

### Состояния

- Offline
    - Просмотр из кэша
    - В разделах показывается пометка “данные могут быть устаревшими”
- ErrorLoadObject
    - Экран ошибки с повтором

---

## Экран списка осмотров

### Назначение

- Реестр осмотров с фильтрацией.

### Структура и расположение

- Верхняя панель
    - Заголовок “Осмотры”
    - Поиск
    - Фильтр
- Под панелью
    - Чипы фильтров: статус, период, исполнитель, объект
- Список
    - Карточка осмотра
        - объект
        - дата/время
        - исполнитель
        - статус
        - признак “требует утверждения” или “просрочен”
- FAB “+” для создания, если разрешено ролью

### Элементы

- InspectionListItemCard
- FilterChipsRow
- FABCreateInspection

### Поведение

- Тап по карточке
    - Открыть “Детали осмотра”
- Тап по FAB
    - Открыть “Планирование осмотра”

---

## Экран планирования осмотра

### Назначение

- Создание или редактирование осмотра.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “Новый осмотр” или “Редактирование осмотра”
- Контент форма
    - Блок “Объект”
        - поле выбора объекта, автопоиск, открытие списка
    - Блок “Дата и время”
        - выбор даты
        - выбор времени
    - Блок “Исполнитель”
        - выбор пользователя
    - Блок “Шаблон чек-листа”
        - выбор шаблона
        - ссылка “посмотреть пункты”, открывает модальное окно предпросмотра
    - Блок “Комментарий”
        - многострочное поле
    - Блок “Приоритет”, если используется
        - переключатель или выбор из списка
- Нижняя панель действий
    - Кнопка “Сохранить”
    - Кнопка “Отменить осмотр”, если это редактирование существующего и роль позволяет

### Элементы

- PickerObject
- DatePicker
- TimePicker
- PickerAssignee
- PickerChecklistTemplate
- TextAreaComment
- ButtonSave
- ButtonCancelOrDelete

### Состояния

- Валидация обязательных полей
- ErrorNetwork
- Conflict предупреждение, если на сервере есть конфликт расписания, если это реализуется

---

## Экран выполнения осмотра

### Назначение

- Заполнение чек-листа и фиксация материалов.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок: “Осмотр”
    - Индикатор статуса синхронизации: online/offline/queued
- Шапка осмотра
    - объект
    - дата/время
    - исполнитель
    - статус
- Секция чек-листа
    - список пунктов
    - каждый пункт представляет собой карточку с блоками:
        - заголовок пункта
        - переключатель статуса: OK / Проблема / Не проверено
        - поле комментария
        - блок вложений
            - горизонтальная лента миниатюр
            - кнопка “Добавить фото”
            - кнопка “Добавить видео”
        - кнопка “Создать дефект”, если пункт отмечен как проблема
- Итоговый блок
    - многострочный “Итоговый комментарий”
    - кнопка “Завершить осмотр”
- Модальные экраны
    - предпросмотр фото/видео
    - аннотация изображения, если включено

### Элементы

- ChecklistItemCard
    - SegmentStatus
    - TextAreaItemComment
    - AttachmentPreviewRow
    - ButtonAddPhoto
    - ButtonAddVideo
    - ButtonCreateDefectFromItem
- TextAreaFinalComment
- ButtonFinishInspection

### Поведение

- Автосохранение после каждого изменения
- В офлайн-режиме действия попадают в очередь синхронизации
- При завершении
    - проверка обязательных пунктов
    - изменение статуса осмотра
    - формирование дефектов по отмеченным проблемам, если выбран сценарий

### Состояния

- Offline
    - заметная плашка
    - рядом с кнопкой завершения показ “будет отправлено при появлении сети”
- UploadFailed
    - список вложений с ошибкой и кнопкой повторить загрузку

---

## Экран деталей результата осмотра

### Назначение

- Просмотр итогов осмотра и утверждение.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “Результат осмотра”
    - Меню: экспорт PDF, если включено
- Контент
    - Сводка: объект, дата, исполнитель, статус
    - Блок итогового комментария
    - Список пунктов чек-листа с результатами и вложениями
- Нижняя область действий
    - Кнопка “Утвердить”, если роль позволяет и статус ожидает утверждения
    - Кнопка “Отклонить”, если требуется сценарий возврата

### Элементы

- SummaryCardInspectionResult
- ChecklistResultList
- ButtonApprove
- ButtonReject

---

## Экран списка дефектов

### Назначение

- Реестр дефектов с быстрыми фильтрами.

### Структура и расположение

- Верхняя панель
    - Заголовок “Дефекты”
    - Поиск
    - Фильтры
- Под панелью
    - Быстрые фильтры-чипы: просроченные, высокий приоритет, назначенные мне
- Список
    - Карточка дефекта
        - краткое описание
        - объект
        - приоритет
        - статус
        - дедлайн
        - ответственный
- FAB “+” для создания дефекта

### Элементы

- DefectListItemCard
- QuickFilterChipsRow
- FABCreateDefect

---

## Экран карточки дефекта

### Назначение

- Полная информация и управление жизненным циклом дефекта.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок: краткое описание
    - Меню: редактировать, удалить или закрыть, если разрешено ролью
- Контент секциями
    - Секция “Сводка”
        - объект с кликом в карточку объекта
        - статус
        - приоритет
        - дедлайн
        - ответственный
    - Секция “Вложения”
        - лента миниатюр
        - кнопка добавить вложение
    - Секция “Описание”
        - текст описания
    - Секция “Комментарии”
        - список сообщений
        - поле ввода комментария
        - кнопка отправки
    - Секция “История”
        - список событий: смена статусов, переназначения, подтверждения
- Нижняя панель действий
    - Кнопки статуса в зависимости от роли и текущего состояния
        - “В работу”
        - “Решено”
        - “Закрыть”
        - “Вернуть в работу”

### Элементы

- SummaryDefectCard
- AttachmentsRow
- CommentsThread
- CommentInputBar
- HistoryTimeline
- StatusActionButtons

---

## Экран списка расходов

### Назначение

- Личный реестр расходов пользователя.

### Правило доступа

- Пользователь видит только свои расходы и расходы, где он является участником подтверждения.

### Структура и расположение

- Верхняя панель
    - Заголовок “Расходы”
    - Поиск
    - Фильтр
- Под панелью
    - Чипы фильтров: объект, категория, тип, статус подтверждения
    - Сводная панель итогов за период
        - запланировано
        - потрачено
        - отклонение
- Список
    - Карточка расхода
        - дата
        - объект
        - описание
        - сумма
        - тип: план/факт
        - статус: черновик/ожидает/подтвержден/отклонён
- FAB “+” для создания расхода

### Элементы

- ExpenseSummaryBar
- ExpenseListItemCard
- FABCreateExpense

---

## Экран создания расхода

### Назначение

- Создание записи расхода вручную с возможностью прикрепить чек.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “Новый расход”
- Контент форма
    - Объект: выбор из списка
    - Категория: выбор из справочника
    - Тип: переключатель план/факт
    - Сумма: числовое поле
    - Дата: выбор даты
    - Описание: многострочное поле
    - Вложения: блок прикрепления чека
        - кнопка “Сделать фото”
        - кнопка “Выбрать файл”
        - список прикреплённых вложений
- Нижняя панель действий
    - “Сохранить”
    - “Отправить на подтверждение”, если включён сценарий согласования

### Элементы

- PickerObject
- PickerCategory
- SegmentPlanFact
- TextFieldAmount
- DatePicker
- TextAreaDescription
- AttachmentUploader
- ButtonSave
- ButtonSendForApproval

### Валидация

- Объект обязателен
- Сумма обязателена и больше нуля
- Тип обязателен
- Дата обязательна

---

## Экран карточки расхода

### Назначение

- Просмотр деталей, подтверждение или отклонение.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “Расход”
    - Меню: редактировать, если автор и статус позволяет
- Контент секциями
    - Сводка: объект, тип, сумма, дата, статус
    - Описание
    - Вложения чеков
    - История подтверждений
- Нижняя панель действий
    - “Подтвердить”, если пользователь является участником подтверждения
    - “Отклонить”, если предусмотрено
    - “Редактировать”, если автор и расход не подтверждён

---

## Экран приборов учёта и показаний

### Назначение

- Ввод и просмотр истории показаний.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “Показания”
- Контент
    - Список приборов
        - тип
        - единицы измерения
        - последнее показание и дата
        - кнопка “Ввести”
    - При выборе прибора открывается экран/модалка “Новое показание”
        - предыдущее значение
        - поле нового значения
        - дата
        - кнопка “Сохранить”
    - История показаний
        - таблица или список записей

### Проверки

- Предупреждение, если новое значение меньше предыдущего
- Предупреждение при аномальном скачке

---

## Экран центра уведомлений

### Назначение

- Просмотр истории уведомлений и переход к сущностям.

### Структура и расположение

- Верхняя панель
    - Заголовок “Уведомления”
    - Действие “Очистить прочитанные”
- Контент
    - Список уведомлений
        - иконка типа события
        - краткий текст
        - время
        - метка непрочитано

### Поведение

- Тап по уведомлению
    - Переход в карточку соответствующей сущности
- Свайп или контекстное меню
    - Пометить как прочитанное
    - Удалить из списка, если поддерживается

---

## Экран журнала активности

### Назначение

- Просмотр трассируемости изменений по объекту или сущности.

### Структура и расположение

- Верхняя панель
    - Назад
    - Заголовок “История”
    - Фильтр событий
- Контент
    - Лента событий
        - тип события
        - автор
        - время
        - краткое описание
        - ссылка на связанную сущность, если применимо

---

## Экран профиля и настроек

### Назначение

- Управление профилем и пользовательскими настройками.

### Структура и расположение

- Верхняя панель
    - Заголовок “Профиль”
- Контент секциями
    - Секция “Профиль”
        - имя
        - e-mail
        - контакты
        - кнопка “Редактировать”
    - Секция “Уведомления”
        - переключатели по типам событий
    - Секция “Интерфейс”
        - тема
        - язык
    - Секция “Безопасность”
        - смена пароля
        - выход со всех устройств, если поддерживается
    - Секция “Сессия”
        - кнопка “Выйти”

### Поведение

- Все изменения настроек применяются сразу, при необходимости синхронизируются с сервером.
